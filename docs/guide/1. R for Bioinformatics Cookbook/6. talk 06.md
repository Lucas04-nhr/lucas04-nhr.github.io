---
title: Data wrangler, part 2
createTime: 2025/12/07 21:59:34
permalink: /docs/r-course/talk06/
---

# Talk 06 {#talk06}

::: note
Reference: [R for Data Science](https://r4ds.had.co.nz)

The book updated to 2^nd^ ed. on July, 2023, here’s a [link](https://r4ds.hadley.nz) to the official website.

::: flex around center
<LinkCard 
    icon="ic:outline-description"
    title="View the original slide"
    href="https://github.com/Lucas04-nhr/R-for-Data-Science/blob/main/talk06.pdf" >
</LinkCard>

<LinkCard 
    icon="ic:round-document-scanner"
    title="View the original Rmd file"
    href="https://github.com/Lucas04-nhr/R-for-Data-Science/blob/main/talk06.Rmd" >
</LinkCard>
:::

:::

## Data Wrangler - `tidyr` {#tidyr}

You can get `tidyr` in the package set `tidyverse`, or simply install it the first time you want to use it via `install.packages("tidyr")`.

### The usage of `tidyr` {#usage-tidyr}

You can use `tidyr` to change the shape of your data, including:

```R
# Eg 1
library(tidyverse)
grades2 =
  read_tsv(file = "data/grades2.txt")

grades3 =
  grades2 %>%
  pivot_longer(
    - name,
    names_to = "course",
    values_to = "grade"
  )
```

```R
# Eg 2
grades3_wide = grades3_long %>%
  pivot_wider(
    names_from = "course",
    values_from = "grade"
  )
```

### What’s the difference between wide and long data? {#difference-wide-long}

Here are pros and cons of wide data:

:::: card-grid

::: card title="Pros" icon="ic:baseline-gpp-good"

- Natural and easy to understand;
- Easy to handle.
  :::

::: card title="Cons" icon="ic:baseline-gpp-bad"

- Not easy to handle;
- More problematic when sparse.
  :::

::::

### How to handle missing values in `tidyr`? {#handle-missing-values}

```R
grades3_1 = grades3[ !is.na(grades3$grade), ]
grades3_2 = grades3[ complete.cases(grades3), ]

# A better solution
grades3_long = grades2 %>%
  pivot_longer( - name,
                names_to = "course",
                values_to = "grade",
                values_drop_na = TRUE)

# Pay attention to the variant named "values_drop_na"
```

### More functions in `tidyr` {#more-functions-tidyr}

::: note
For more details, please refer to the official documentation of `tidyr` [here](https://r4ds.hadley.nz/data-tidy.html).
:::

- `tidyr::separate()`
- `tidyr::unite()`

==**Example**=={.note}
::: code-tabs
@tab Separate

```R
separate(
  data,
  col,
  into,
  sep = "[^[:alnum:]]+",
  remove = TRUE,
  convert = FALSE,
  extra = "warn",
  fill = "warn",
  ...
)

# Default parameters are listed.
```

@tab Unite

```R
unite(
  data,
  col,
  ...,
  sep = "_",
  remove = TRUE,
  na.rm = FALSE
)

# Default parameters are listed.
```

:::
